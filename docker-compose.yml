# Docker Compose Development Environment Configuration
# File: docker-compose.yml

services:
  dev-environment:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: my-dev-env
    hostname: dev-container
    network_mode: host
    volumes:
      # Persistent code directory
      - ./workspace:/workspace
      # Persistent VS Code configuration and extensions
      - vscode-server:/root/.vscode-server
      - vscode-extensions:/root/.vscode-server/extensions
      # Persistent development tools configuration
      - dev-config:/root/.config
      - dev-cache:/root/.cache
      # Shared host machine configurations (read-only)
      - ~/.gitconfig:/root/.gitconfig:ro
      - ~/.ssh:/root/.ssh:ro
      # Python package cache sharing
      - ~/.cache/pip:/root/.cache/pip
    environment:
      - WORKSPACE=/workspace
      - TZ=Asia/Shanghai
      - CLAUDE_API_KEY=${CLAUDE_API_KEY:-}
    stdin_open: true
    tty: true
    restart: unless-stopped
    working_dir: /workspace

volumes:
  vscode-server:
    driver: local
  vscode-extensions:
    driver: local
  dev-config:
    driver: local
  dev-cache:
    driver: local